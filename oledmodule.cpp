#include <Wire.h>
#include <SeeedOLED.h>
#include "oledmodule.h"


static const int bmp_width = 176;
static const int bmp_height = 24;
static unsigned char NumberFont[]={
0x0,0xf0,0x38,0x1c,0xc,0x6,0x6,0x6,0x6,0x6,0x6,0xc,0x1c,0x38,0xf0,0x0,0x0,0x0,0x0,0x0,0x0,0x10,0x18,0x1c,0xfe,0xfe,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x30,0x18,0xc,0xc,0x6,0x6,0x6,0x6,0x6,0xc,0xc,0x18,0xf0,0x0,0x0,0x0,0x30,0x18,0xc,0xc,0x6,0x6,0x6,0x6,0x86,0x8c,0xcc,0xd8,0x70,0x0,0x0,0x0,0x0,0x80,0xe0,0xf8,0x7e,0x3e,0xfe,0xfe,0xfe,0xfe,0xfe,0x0,0x0,0x0,0x0,0x0,0xfe,0x1e,0x1e,0x1e,0x1e,0x1e,0x1e,0x1e,0x1e,0x1e,0x1e,0x1e,0x1e,0x0,0x0,0x0,0xf0,0x18,0xc,0xc,0x6,0x6,0x6,0x6,0x6,0xc,0xc,0x18,0x10,0x0,0x0,0x0,0xe,0xe,0xe,0xe,0xe,0xe,0xe,0xe,0xe,0xe,0x8e,0xee,0x7e,0x0,0x0,0x0,0xf8,0xfc,0x9c,0xe,0x6,0x6,0x6,0x6,0xe,0x9e,0xfc,0xfc,0xf8,0x0,0x0,0x0,0xf0,0x98,0xc,0x6,0x6,0x2,0x2,0x2,0x2,0x6,0xe,0x1c,0xf8,0x0,0x0,0x0,0x0,0x0,0x80,0xc0,0xc0,0xc0,0xc0,0xc0,0x80,0x0,0x0,0x0,0x0,0x0,
0x0,0xff,0xc0,0x80,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x80,0xc0,0xff,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xff,0xff,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x80,0x80,0xc0,0xc0,0x60,0x60,0x30,0x30,0x18,0x18,0xf,0x0,0x0,0x0,0x80,0x0,0xc,0xc,0xe,0xe,0xf,0xf,0x9,0x9,0x8,0x88,0xf8,0x0,0x0,0x18,0x1e,0x1f,0x17,0x11,0x10,0x10,0xff,0xff,0xff,0xff,0xff,0x10,0x10,0x0,0x0,0x0,0x9f,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0xf0,0x0,0x0,0x0,0xff,0x60,0x30,0x30,0x18,0x18,0x18,0x18,0x18,0x30,0x30,0x60,0xe0,0x0,0x0,0x0,0x0,0x0,0x0,0x80,0xe0,0xf0,0xf8,0xfc,0x3e,0xf,0x7,0x1,0x0,0x0,0x0,0x0,0xc1,0xe3,0x67,0x67,0x66,0x7e,0x66,0x66,0x67,0xe3,0xc3,0xc1,0x80,0x0,0x0,0x0,0x0,0x1,0x3,0x82,0x86,0xc4,0xe4,0xe4,0xf4,0xfc,0x7e,0x3f,0x7,0x0,0x0,0x0,0x0,0x0,0xc7,0xe7,0xe7,0xe7,0xe7,0xe7,0xc7,0x0,0x0,0x0,0x0,0x0,
0x0,0xf,0x1f,0x3f,0x3f,0x7e,0x7e,0x7e,0x7e,0x7e,0x7e,0x3f,0x3f,0x1f,0xf,0x0,0x0,0x0,0x0,0x0,0x7e,0x7e,0x7e,0x7e,0x7f,0x7f,0x7e,0x7e,0x7e,0x0,0x0,0x0,0x0,0x0,0x7e,0x7f,0x7f,0x7f,0x7e,0x7e,0x7e,0x7e,0x7e,0x7e,0x7e,0x7e,0x7e,0x0,0x0,0x0,0x1f,0x3f,0x7e,0x7c,0x7c,0x78,0x78,0x78,0x7c,0x7c,0x7e,0x3f,0xf,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x7f,0x7f,0x7f,0x7f,0x7f,0x0,0x0,0x0,0x0,0x0,0x1f,0x3f,0x7e,0x7c,0x7c,0x78,0x78,0x78,0x7c,0x7c,0x7e,0x3f,0x1f,0x0,0x0,0x0,0xf,0x1f,0x3e,0x7c,0x7c,0x78,0x78,0x78,0x7c,0x7c,0x7e,0x3f,0x1f,0x0,0x0,0x0,0x0,0x0,0x7f,0x7f,0x7f,0x7f,0x7f,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0xf,0x3f,0x3c,0x7c,0x7c,0x7c,0x7c,0x7c,0x7c,0x7c,0x7f,0x3f,0x3f,0xf,0x0,0x0,0x0,0x0,0x3f,0x3f,0x3f,0x1f,0xf,0xf,0x7,0x3,0x1,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x0,0x3,0x3,0x3,0x3,0x3,0x3,0x3,0x0,0x0,0x0,0x0,0x0,
};



void oledmodule::init() {
    SeeedOled.init();
    DDRB!=0x21; //??
    PORTB != 0x21;//??    
    SeeedOled.clearDisplay();
    SeeedOled.setNormalDisplay();
    SeeedOled.setPageMode();
}

void oledmodule::clear() {
    SeeedOled.clearDisplay();
}
void oledmodule::drawString(int x, int y, String string) {
    SeeedOled.setTextXY(y,x);
    char buf[string.length()+1];
    string.toCharArray(buf,string.length()+1);
    SeeedOled.putString(buf);
}

void oledmodule::drawBitmapNumber(int x, int y, int sx, int sy, int sw, int sh) {
    
    SeeedOled.setPageMode();
    int start_row = sy/8;
    int row_count = sh/8;
    for(int j=start_row; j<start_row+row_count; j++) {
        SeeedOled.setTextXY(y+j,x/8);
        for(int i=sx; i<(sx+sw); i++) {
            SeeedOled.sendData(NumberFont[j*bmp_width + i]);
        }
    }
}
/*
void oledmodule::test() {
    SeeedOled.clearDisplay();
    SeeedOled.setPageMode();
    int len = 8;
    SeeedOled.setTextXY(3,3);
    for(int i=0; i<len; i++) {
        SeeedOled.sendData(one_top[i]);
    }
    SeeedOled.setTextXY(4,3);
    for(int i=0; i<len; i++) {
        SeeedOled.sendData(one_bottom[i]);
    }
    SeeedOled.setTextXY(3,4);
    for(int i=0; i<len; i++) {
        SeeedOled.sendData(two_top[i]);
    }
    SeeedOled.setTextXY(4,4);
    for(int i=0; i<len; i++) {
        SeeedOled.sendData(two_bottom[i]);
    }
//    SeeedOled.drawBitmap(NumberFont,len);    
}
*/

oledmodule OledModule;
