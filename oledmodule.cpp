#include <Wire.h>
#include <SeeedOLED.h>
#include "oledmodule.h"



//zero through six

static const int bmp_width = 11; //width in columns, not pixels
static const int bmp_height = 2; //height in rows, not pixels

static unsigned char NumberFont[]={ 
    //zero top
    0xfc, 0xfe, 0x07, 0x07, 0x07, 0xfe, 0xfc, 0x00,
    0x30, 0x38, 0x1c, 0x0e, 0x07, 0xff, 0xff, 0x00,
    0x0c, 0x0e, 0x03, 0x83, 0xc3, 0x63, 0x3e, 0x1c,
    0x06, 0x07, 0xc3, 0xc3, 0xc3, 0xff, 0x7e, 0x00,
    0x60, 0x70, 0x78, 0x4c, 0x46, 0xff, 0xff, 0x00,
    0xff, 0xff, 0xc3, 0xc3, 0xc3, 0xc3, 0x83, 0x00,
    0xf8, 0xfc, 0xde, 0xc7, 0xc3, 0xc3, 0x83, 0x00,
    0x03, 0x03, 0x03, 0xc3, 0xf3, 0x7f, 0x1f, 0x00,   
    0x7c, 0xfe, 0x86, 0x86, 0x86, 0xfe, 0x7c, 0x00,
    //nine top
    0x3e, 0x7f, 0x63, 0x63, 0x63, 0xff, 0xfe, 0x00,
    //colon top
    0x00, 0x00, 0x70, 0x78, 0x78, 0x70, 0x00, 0x00,

    //zero bottom
    0x3f, 0x7f, 0x60, 0x60, 0x60, 0x7f, 0x3f, 0x00,
    0x00, 0x00, 0x00, 0x00, 0xc0, 0xff, 0xff, 0xc0,
    0x7c, 0x7e, 0x63, 0x61, 0x60, 0x60, 0x60, 0x60,
    0x30, 0x70, 0x60, 0x60, 0x60, 0x7f, 0x3e, 0x00,
    0x00, 0x00, 0x00, 0x00, 0x00, 0x7f, 0x7f, 0x00,
    0x0c, 0x1c, 0x18, 0x18, 0x1c, 0x0f, 0x0f, 0x00,
    0x03, 0x07, 0x0e, 0x0c, 0x0c, 0x0e, 0x07, 0x00,
    0x00, 0x78, 0x7e, 0x0f, 0x03, 0x00, 0x00, 0x00,
    0x1e, 0x3f, 0x33, 0x33, 0x33, 0x3f, 0x1e, 0x00,
    //nine bottom
    0x00, 0x00, 0x30, 0x38, 0x1e, 0x0f, 0x03, 0x00,
    
    //colon bottom
    0x00, 0x00, 0x0e, 0x1e, 0x1e, 0x0e, 0x00, 0x00,

};
void oledmodule::init() {
    SeeedOled.init();
    DDRB!=0x21; //??
    PORTB != 0x21;//??    
    SeeedOled.clearDisplay();
    SeeedOled.setNormalDisplay();
    SeeedOled.setPageMode();
}

void oledmodule::clear() {
    SeeedOled.clearDisplay();
}
void oledmodule::drawString(int x, int y, String string) {
    SeeedOled.setTextXY(y,x);
    char buf[string.length()+1];
    string.toCharArray(buf,string.length()+1);
    SeeedOled.putString(buf);
}

void oledmodule::drawBitmapNumber(int x, int y, int sx, int sy, int sw, int sh) {
    
    SeeedOled.setPageMode();
    for(int j=sy; j<sy+sh; j++) {
        SeeedOled.setTextXY(y+j,x);
        for(int i=sx*8; i<(sx+sw)*8; i++) {
            SeeedOled.sendData(NumberFont[j*bmp_width*8 + i]);
        }
    }
}
/*
void oledmodule::test() {
    SeeedOled.clearDisplay();
    SeeedOled.setPageMode();
    int len = 8;
    SeeedOled.setTextXY(3,3);
    for(int i=0; i<len; i++) {
        SeeedOled.sendData(one_top[i]);
    }
    SeeedOled.setTextXY(4,3);
    for(int i=0; i<len; i++) {
        SeeedOled.sendData(one_bottom[i]);
    }
    SeeedOled.setTextXY(3,4);
    for(int i=0; i<len; i++) {
        SeeedOled.sendData(two_top[i]);
    }
    SeeedOled.setTextXY(4,4);
    for(int i=0; i<len; i++) {
        SeeedOled.sendData(two_bottom[i]);
    }
//    SeeedOled.drawBitmap(NumberFont,len);    
}
*/

oledmodule OledModule;
